import{a as he,b as fe,c as ee,f as te,h as Ce,i as ve,j as xe,k as be,l as ye,m as we,n as ne}from"./chunk-ROR7AAS5.js";import{h as D,i as j,j as B,k as J,l as Q,o as R}from"./chunk-VX5J622G.js";import{$ as x,$a as oe,Da as S,Fa as m,Ja as Z,Oa as c,Pa as p,Qa as y,Ra as w,Sa as M,Ua as T,V as F,Ya as C,Za as u,_ as v,_a as pe,ab as $,bb as N,cb as me,eb as q,fb as b,gb as de,hb as k,jb as ue,mb as L,nb as ge,ob as E,pa as H,pb as V,qb as _e,rb as K,ub as U,va as s,wa as z,ya as W}from"./chunk-IIZCY6ZS.js";import"./chunk-VHCA6YAO.js";function ke(r,l){r&1&&(w(0),oe(1,1),M())}var Ie=[[["","title",""]],"*"],Ve=r=>({"cursor-all":r}),Fe=r=>({"fw-bolder":r}),ze=(r,l)=>({"bi-caret-down-fill":r,"bi-caret-right-fill":l}),Ne=["[title]","*"],Me=(()=>{let l=class l{constructor(t){this.el=t,this.draggable=!0,this.openChange=new W,this.isMobile=window.innerWidth<=800&&window.innerHeight<=600,this.z=0,this.offset={x:0,y:0}}ngAfterViewInit(){let t=this.el.nativeElement;this.container=t.querySelector(".drag"),this.z=Number(document.defaultView.getComputedStyle(this.container,null).zIndex);let e=0;document.querySelectorAll("app-draggable").forEach(a=>{let i=a.children[0];if(e+=i.clientHeight+5,a.isSameNode(t)){let d=e-i.clientHeight;this.container.style.top=d+"px"}})}register(t,e){let n=this.offset,a=this.container;n.x=t-Number(a.style.left.replace("px","")),n.y=e-Number(a.style.top.replace("px","")),this.container.style.zIndex=(this.z+100).toString()}move(t,e){if(!this.draggable)return;let n=this.offset,a=this.container,i=t-n.x,d=e-n.y;a.style.top=d+"px ",a.style.left=i+"px "}onEnd(){this.container.style.zIndex=this.z.toString()}onTouchStart(t){if(t.touches.length==1){let e=t.touches[0];this.register(e.clientX,e.clientY)}}onDragStart(t){this.register(t.clientX,t.clientY)}onTouchMove(t){if(t.touches.length==1){let e=t.touches[0];this.move(e.clientX,e.clientY)}}onDragMove(t){t.buttons==1&&this.move(t.clientX,t.clientY)}onClickOpen(){this.open=!this.open,this.openChange.emit(this.open)}};l.\u0275fac=function(e){return new(e||l)(z(H))},l.\u0275cmp=F({type:l,selectors:[["app-draggable"]],inputs:{title:"title",open:"open",draggable:"draggable"},outputs:{openChange:"openChange"},standalone:!0,features:[L],ngContentSelectors:Ne,decls:10,vars:12,consts:[[1,"bg-body","border","rounded","px-2","shadow-sm","drag"],[1,"d-flex","align-items-center","justify-content-between","drag-title",3,"ngClass","touchstart","touchmove","touchend","mouseup","mousedown","mousemove"],[1,"d-flex","align-items-center"],[1,"text-secondary","border-0",3,"hidden"],[1,"bi","bi-grip-vertical"],[3,"ngClass"],["type","button","title","Minimize",1,"btn","border-0",3,"click"],[1,"bi",3,"ngClass"],[4,"ngIf"]],template:function(e,n){e&1&&(pe(Ie),c(0,"div",0)(1,"div",1),C("touchstart",function(i){return n.onTouchStart(i)})("touchmove",function(i){return n.onTouchMove(i)})("touchend",function(){return n.onEnd()})("mouseup",function(){return n.onEnd()})("mousedown",function(i){return n.onDragStart(i)})("mousemove",function(i){return n.onDragMove(i)}),c(2,"div",2)(3,"div",3),y(4,"i",4),p(),c(5,"div",5),oe(6),p()(),c(7,"button",6),C("click",function(){return n.onClickOpen()}),y(8,"i",7),p()(),S(9,ke,2,0,"ng-container",8),p()),e&2&&(s(),m("ngClass",E(5,Ve,n.draggable)),s(2),m("hidden",!n.draggable),s(2),m("ngClass",E(7,Fe,n.open)),s(3),m("ngClass",V(9,ze,n.open,!n.open)),s(),m("ngIf",n.open))},dependencies:[R,D,B],styles:[".no-select[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;cursor:none}.flex[_ngcontent-%COMP%], .flex-center[_ngcontent-%COMP%]{display:flex}.flex-center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.w-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{width:-webkit-fill-available}.h-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{height:-webkit-fill-available}.w-min[_ngcontent-%COMP%]{width:min-content}.p-1[_ngcontent-%COMP%]{padding:.25rem}.pointer[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{cursor:pointer}.cursor-default[_ngcontent-%COMP%]{cursor:default!important}.cursor-all[_ngcontent-%COMP%]{cursor:all-scroll}.cursor-resize[_ngcontent-%COMP%]{cursor:nw-resize}.hover[_ngcontent-%COMP%]:hover{background-color:#dcdcdc}p[_ngcontent-%COMP%], div[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{overflow:hidden}.drag[_ngcontent-%COMP%]{position:fixed;z-index:1000}"]});let r=l;return r})();var De=r=>({"bg-warning":r}),Re=(r,l)=>({"bi-eye":r,"bi-eye-slash":l});function He(r,l){if(r&1){let o=T();w(0),c(1,"div",5),C("click",function(){let n=v(o).$implicit,a=u();return x(a.onSelected(n))}),c(2,"div",6)(3,"input",7),C("ngModelChange",function(e){let a=v(o).$implicit;return x(a.visible=e)}),p(),c(4,"label",8),y(5,"i",9),p()(),c(6,"div",10),b(7),p(),c(8,"div")(9,"button",11),C("click",function(){let n=v(o).$implicit,a=u();return x(a.onDelete(n))}),y(10,"i",12),p()()(),M()}if(r&2){let o=l.$implicit,t=l.index,e=u();s(),m("ngClass",E(6,De,e.active==o)),s(2),N("id","_show_",t,""),m("ngModel",o.visible),s(),N("for","_show_",t,""),s(),m("ngClass",V(8,Re,o.visible,!o.visible)),s(2),k(" ",o.name," ")}}var X=(()=>{let l=class l{constructor(t){this.el=t,this.width=0,this.height=0}newItem(){let t=this.list.map(a=>a.id),e=Math.max(...t);return isFinite(e)||(e=0),{id:e+1,setId:`layer_${e+1}`,name:`Layer ${e+1}`,width:this.width,height:this.height,visible:!0,img:""}}getActiveElement(){return document.getElementById("layers").querySelector(".active")}onNew(){let t=this.newItem();this.list.push(t)}onDelete(t){let e=this.list.findIndex(n=>n.id==t.id);e<0||this.list.splice(e,1)}onSelected(t){let e=document.getElementById("layers");if(e.querySelectorAll("canvas").forEach(a=>a.classList.toggle("active",!1)),this.active?.id==t.id?this.active=void 0:this.active=t,this.active==null)return;e.querySelector(`#${this.active.setId}`)?.classList.toggle("active",!0)}render(t,e){let n=new Image;n.onload=()=>{t.getContext("2d").drawImage(n,0,0)},n.src=e.img}tracker(t,e){return e}};l.\u0275fac=function(e){return new(e||l)(z(H))},l.\u0275cmp=F({type:l,selectors:[["app-layers"]],inputs:{list:"list",width:"width",height:"height"},standalone:!0,features:[L],decls:5,vars:2,consts:[[1,"btn-group","wh-fill"],["type","button","title","New",1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-circle"],[1,"btn-group-vertical","wh-fill"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover","d-flex","align-items-center","justify-content-between","w-fill",3,"ngClass","click"],[1,"form-check","ps-2"],["name","show","type","checkbox","title","Visibility",1,"btn-check",3,"id","ngModel","ngModelChange"],[3,"for"],[1,"bi",3,"ngClass"],[1,"small"],["type","button","title","Delete",1,"btn","text-danger","rounded-circle",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){e&1&&(c(0,"div",0)(1,"button",1),C("click",function(){return n.onNew()}),y(2,"i",2),p()(),c(3,"div",3),S(4,He,11,11,"ng-container",4),p()),e&2&&(s(4),m("ngForOf",n.list)("ngForTrackBy",n.tracker))},dependencies:[R,D,j,ne,he,ee,te]});let r=l;return r})();function je(r,l){}function Be(r,l){}function Ae(r,l){}var qe=(r,l,o,t,e)=>({mode:"slider",id:"lightness",key:"light",title:"Light",max:100,value:r,text:l,color:o,divider:t,items:e}),Xe=(r,l,o,t,e)=>({mode:"slider",id:"saturation",key:"saturation",title:"Mono",max:100,value:r,text:l,color:o,divider:t,items:e}),Ye=(r,l,o,t,e)=>({mode:"pallete",id:"hue",key:"color",title:"Base",max:360,value:r,text:l,color:o,divider:t,items:e});function Ge(r,l){if(r&1&&(w(0),S(1,je,0,0,"ng-template",5)(2,Be,0,0,"ng-template",5)(3,Ae,0,0,"ng-template",5),M()),r&2){let o=u(),t=q(15);s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",K(6,qe,o.hsl.l,"hsl(0, 0%, "+(100-o.hsl.l)+"%)","hsl(0, 0%, "+o.hsl.l+"%)",o.divider.light,o.list.l)),s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",K(12,Xe,o.hsl.s,"hsl(0, 0%, "+(100-o.hsl.s)+"%)","hsl(0, 0%, "+o.hsl.s+"%)",o.divider.saturation,o.list.s)),s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",K(18,Ye,o.hsl.h,"hsl(0, 0%, "+(100-o.hsl.s)+"%)","hsl("+o.hsl.h+",100% ,50%)",o.divider.color,o.list.h))}}function We(r,l){if(r&1){let o=T();w(0),c(1,"div",10)(2,"input",11),C("input",function(e){v(o);let n=u(2);return x(n.onHSLChange(e))}),p()(),M()}if(r&2){let o=u(),t=o.title,e=o.value,n=o.id;s(2),me("title","",t,": ",e,""),m("id","_"+n)("name",n)("value",e)}}var Ze=(r,l)=>({active:r,"p-0":l}),Ke=r=>({backgroundColor:r});function Ue(r,l){if(r&1){let o=T();w(0),c(1,"button",24),C("click",function(e){v(o);let n=u(3);return x(n.onHSLChange(e))})("mousemove",function(e){v(o);let n=u(3);return x(n.onPalleteMouseMove(e))}),p(),M()}if(r&2){let o=l.$implicit;u();let t=q(8),e=u(),n=e.id,a=e.value;s(),$("title",o.value),m("name",n)("value",o.value)("ngClass",V(5,Ze,o.value==a,t.checked))("ngStyle",E(8,Ke,o.hsl))}}function Je(r,l){if(r&1){let o=T();w(0),c(1,"div",12)(2,"div",13),y(3,"input",14,15),c(5,"label",16),b(6,"Pallete"),p(),y(7,"input",17,18),c(9,"label",19),b(10,"Slide"),p()()(),c(11,"input",20),C("input",function(e){v(o);let n=u().key,a=u();return x(a.onDividerChange(e,n))}),p(),c(12,"div",21)(13,"div",22),S(14,Ue,2,10,"ng-container",23),p()(),M()}if(r&2){let o=u(),t=o.id,e=o.max,n=o.divider,a=o.items,i=u();s(11),N("id","div_",t,"")("title","Smoothness: ",e-n,""),m("max",e)("value",e-n),s(3),m("ngForOf",a)("ngForTrackBy",i.tracker)}}var Qe=(r,l)=>({backgroundColor:r,color:l});function et(r,l){if(r&1&&(c(0,"div",6)(1,"div",7)(2,"div",8),b(3),p(),c(4,"div",9),b(5),p()(),S(6,We,3,5,"ng-container",3)(7,Je,15,6,"ng-container",3),p()),r&2){let o=l.mode,t=l.title,e=l.value,n=l.text,a=l.color;s(3),k(" ",t," "),s(),m("title",e)("ngStyle",V(6,Qe,a,n)),s(),k(" ",e," "),s(),m("ngIf",o=="slider"),s(),m("ngIf",o!="slider")}}var Y=(()=>{let l=class l{constructor(){this.divider={light:1,saturation:1,color:5},this.colorChange=new W}ngOnInit(){this.hsl={h:0,s:100,l:50},this.list=this.generateList()}generateList(){let t=this.hsl,e=this.divider,n=_(e.saturation,100),a=_(e.light,100);return{h:d(e.color,360),s:n,l:a};function d(g,h){let f=[];for(let O=0;O<=h/g;O++){let P=h-g*O;f.push({hsl:`hsl(${P}, ${t.s}%, ${t.l}%)`,value:P})}return f}function _(g,h){let f=[];for(let O=0;O<=h/g;O++){let P=g*O;f.push({hsl:`hsl(0, 0%, ${P}%)`,value:P})}return f}}onMainColorChange(t){let e=this.hexToRgb(t.target.value),n=this.RGBToHSL(e);this.hsl=n,this.colorChange.emit(n)}onPalleteMouseMove(t){t.buttons==1&&this.onHSLChange(t)}onHSLChange(t){let e=t.target,n=e.name,a=Number(e.value);if(isNaN(a))return;let i=this.hsl;n=="hue"?i.h=a:n=="saturation"?i.s=a:n=="lightness"&&(i.l=a),this.colorChange.emit(i),this.list=this.generateList()}onDividerChange(t,e){let n=t.target,i=Number(n.max)-Number(n.value);isNaN(i)||i<=0||(this.divider[e]=i,this.list=this.generateList())}hexToRgb(t){return t=t.replace("#",""),{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}rgbToHex(t={r:0,g:0,b:0}){let e=a=>{let i=a.toString(16);return i.length==1?"0"+i:i};return`#${e(t.r)}${e(t.g)}${e(t.b)}`}RGBToHSL(t={r:0,g:0,b:0}){let e=t.r/255,n=t.g/255,a=t.b/255,i=Math.min(e,n,a),d=Math.max(e,n,a),_=d-i,g=0,h=0,f=0;return _==0?g=0:d==e?g=(n-a)/_%6:d==n?g=(a-e)/_+2:g=(e-n)/_+4,g=Math.round(g*60),g<0&&(g+=360),f=(d+i)/2,h=_==0?0:_/(1-Math.abs(2*f-1)),h=+(h*100).toFixed(1),f=+(f*100).toFixed(1),{h:g,s:h,l:f}}HSLToRGB(t={h:0,s:0,l:0}){let e=t.h,n=t.s/100,a=t.l/100,i=(1-Math.abs(2*a-1))*n,d=i*(1-Math.abs(e/60%2-1)),_=a-i/2,g=0,h=0,f=0;return 0<=e&&e<60?(g=i,h=d,f=0):60<=e&&e<120?(g=d,h=i,f=0):120<=e&&e<180?(g=0,h=i,f=d):180<=e&&e<240?(g=0,h=d,f=i):240<=e&&e<300?(g=d,h=0,f=i):300<=e&&e<360&&(g=i,h=0,f=d),g=Math.round((g+_)*255),h=Math.round((h+_)*255),f=Math.round((f+_)*255),{r:g,g:h,b:f}}HSLToHEX(t={h:0,s:0,l:0}){let e=this.HSLToRGB(t);return this.rgbToHex(e)}tracker(t,e){return e}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=F({type:l,selectors:[["app-colors"]],outputs:{colorChange:"colorChange"},standalone:!0,features:[L],decls:16,vars:2,consts:[[1,"d-flex","justify-content-between","align-items-center","my-2","gap-2"],["type","color","title","Color",1,"form-control","form-control-color","p-0",3,"value","change"],[1,"mb-3","p-2","border","rounded"],[4,"ngIf"],["inpPallete",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mb-3"],[1,"d-flex","justify-content-between","align-items-center","gap-2","mb-2"],[1,""],[1,"form-control","form-control-color","d-flex","justify-content-center","align-items-center","title-color","fw-bolder",3,"title","ngStyle"],[1,"input-group"],["type","range","min","0","step","1","max","max",1,"form-range",3,"id","name","title","value","input"],[1,"mb-2"],[1,"btn-group","w-fill"],["id","_view1","name","view","value","pallete","type","radio",1,"btn-check"],["view_1",""],["for","_view1",1,"btn","btn-primary"],["id","_view2","name","view","value","slide","type","radio","checked","",1,"btn-check"],["view_2",""],["for","_view2",1,"btn","btn-primary"],["type","range","min","0","step","1",1,"form-range",3,"id","title","max","value","input"],[1,"h-fill"],[1,"row","mx-0"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"col","colors","btn","rounded-0",3,"title","name","value","ngClass","ngStyle","click","mousemove"]],template:function(e,n){e&1&&(c(0,"div",0)(1,"div"),b(2," Result "),p(),c(3,"div")(4,"input",1),C("change",function(i){return n.onMainColorChange(i)}),p()()(),c(5,"details",2)(6,"summary"),b(7," Mixer "),p(),S(8,Ge,4,24,"ng-container",3),p(),c(9,"details",2)(10,"summary"),b(11," Preset "),p(),c(12,"i"),b(13,"no data yet!"),p()(),S(14,et,8,9,"ng-template",null,4,U)),e&2&&(s(4),m("value",n.HSLToHEX(n.hsl)),s(4),m("ngIf",n.hsl!=null))},dependencies:[R,D,j,B,Q,J],styles:[".no-select[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;cursor:none}.flex[_ngcontent-%COMP%], .flex-center[_ngcontent-%COMP%]{display:flex}.flex-center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.w-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{width:-webkit-fill-available}.h-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{height:-webkit-fill-available}.w-min[_ngcontent-%COMP%]{width:min-content}.p-1[_ngcontent-%COMP%]{padding:.25rem}.pointer[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{cursor:pointer}.cursor-default[_ngcontent-%COMP%]{cursor:default!important}.cursor-all[_ngcontent-%COMP%]{cursor:all-scroll}.cursor-resize[_ngcontent-%COMP%]{cursor:nw-resize}.hover[_ngcontent-%COMP%]:hover{background-color:#dcdcdc}p[_ngcontent-%COMP%], div[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{overflow:hidden}.title-color[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%}div.title-color[_ngcontent-%COMP%]{cursor:default!important}.colors[_ngcontent-%COMP%]{height:30px}.colors[_ngcontent-%COMP%]:hover{border:1px solid}.colors.active[_ngcontent-%COMP%]{outline:3px solid white;z-index:1001}"]});let r=l;return r})();function nt(r,l){r&1&&(w(0),y(1,"i",11),c(2,"span",12),b(3,"Tools"),p(),M())}function it(r,l){if(r&1&&(w(0),y(1,"i"),c(2,"span",12),b(3),p(),M()),r&2){let o=u();s(),Z("bi ",o.settings.selected.icon,""),s(2),k(" ",o.settings.selected.title," ")}}var ot=(r,l)=>({"btn-primary":r,"btn-light":l});function rt(r,l){if(r&1){let o=T();w(0),c(1,"input",13),C("ngModelChange",function(e){v(o);let n=u();return x(n.settings.selected=e)}),p(),c(2,"label",14),y(3,"i"),p(),M()}if(r&2){let o=l.$implicit,t=u();s(),N("id","_setup_",o.title,""),$("title",o.title),m("value",o)("ngModel",t.settings.selected),s(),N("for","_setup_",o.title,""),m("ngClass",V(9,ot,t.settings.selected==o,t.settings.selected!=o)),s(),Z("bi ",o.icon,"")}}function at(r,l){if(r&1&&(w(0),c(1,"option",29),b(2),p(),M()),r&2){let o=l.$implicit;s(),m("value",o.value),s(),de(o.name)}}function lt(r,l){if(r&1){let o=T();w(0),c(1,"div",15)(2,"div",16)(3,"div")(4,"label",17),b(5,"Ratio"),p(),c(6,"select",18),C("ngModelChange",function(e){v(o);let n=u();return x(n.paper.ratio=e)})("change",function(e){v(o);let n=u();return x(n.paper.onRatioChange(e))}),S(7,at,3,2,"ng-container",4),p()()(),c(8,"div",16)(9,"div")(10,"label",19),b(11,"Orientation"),p(),c(12,"select",20),C("ngModelChange",function(e){v(o);let n=u();return x(n.paper.orient=e)})("change",function(e){v(o);let n=u();return x(n.paper.onOrientChange(e))}),c(13,"option",21),b(14,"Landscape"),p(),c(15,"option",22),b(16,"Portrait"),p()()()(),c(17,"div",16)(18,"div")(19,"label",23),b(20,"Width"),p(),c(21,"div",24)(22,"input",25),C("ngModelChange",function(e){v(o);let n=u();return x(n.paper.width=e)})("input",function(e){v(o);let n=u();return x(n.paper.onSizeChange(e))}),p(),c(23,"div",26),b(24,"px"),p()()()(),c(25,"div",16)(26,"div")(27,"label",27),b(28,"Height"),p(),c(29,"div",24)(30,"input",28),C("ngModelChange",function(e){v(o);let n=u();return x(n.paper.height=e)})("input",function(e){v(o);let n=u();return x(n.paper.onSizeChange(e))}),p(),c(31,"div",26),b(32,"px"),p()()()()(),M()}if(r&2){let o=u();s(6),m("ngModel",o.paper.ratio),s(),m("ngForOf",o.paper.listRatio)("ngForTrackBy",o.tracker),s(5),m("ngModel",o.paper.orient),s(10),m("ngModel",o.paper.width),s(8),m("ngModel",o.paper.height)}}function st(r,l){if(r&1){let o=T();w(0),c(1,"div")(2,"div",30)(3,"label"),y(4,"i",31),b(5),p(),c(6,"button",32),C("click",function(){v(o);let e=u();return x(e.canvas.zoom=100)}),y(7,"i",33),p()(),c(8,"input",34),C("ngModelChange",function(e){v(o);let n=u();return x(n.canvas.zoom=e)})("change",function(){v(o);let e=u();return x(e.canvas.setZoom(0))}),p()(),c(9,"div")(10,"div",30)(11,"label"),y(12,"i",35),b(13),p(),c(14,"button",32),C("click",function(){v(o);let e=u();return x(e.canvas.rotate=0)}),y(15,"i",33),p()(),c(16,"input",36),C("ngModelChange",function(e){v(o);let n=u();return x(n.canvas.rotate=e)}),p()(),M()}if(r&2){let o=u();s(5),k(" Zoom : ",o.canvas.zoom,"% "),s(3),m("ngModel",o.canvas.zoom),s(5),k(" Rotation : ",o.canvas.rotate,"% "),s(3),m("ngModel",o.canvas.rotate)}}function ct(r,l){}function pt(r,l){}function mt(r,l){}var dt=r=>({value:r,title:"Opacity",target:"fill",max:100,step:1}),ut=r=>({value:r,title:"Hardness",target:"hardness",max:100,step:1}),gt=r=>({value:r,icon:"search",title:"Size",target:"size",max:300,step:1});function _t(r,l){if(r&1&&(w(0),S(1,ct,0,0,"ng-template",37)(2,pt,0,0,"ng-template",37)(3,mt,0,0,"ng-template",37),M()),r&2){let o=u(),t=q(18);s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",E(6,dt,o.brush.prop.stroke.fill)),s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",E(8,ut,o.brush.prop.stroke.hardness)),s(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",E(10,gt,o.brush.prop.stroke.size))}}function ht(r,l){r&1&&(w(0),y(1,"app-colors"),M())}function ft(r,l){if(r&1&&(w(0),y(1,"app-layers",38),M()),r&2){let o=u();s(),m("height",o.paper.height)("width",o.paper.width)("list",o.layerList)}}function Ct(r,l){if(r&1&&(w(0),y(1,"canvas",39),M()),r&2){let o=l.$implicit;s(),m("width",o.width)("height",o.height)("hidden",!o.visible)("id",o.setId)}}function vt(r,l){if(r&1&&(w(0),y(1,"i"),M()),r&2){let o=u().icon;s(),Z("bi bi-",o," me-1")}}var xt=()=>({width:"inherit"});function bt(r,l){if(r&1){let o=T();c(0,"div",16)(1,"div",40)(2,"div",41)(3,"label",42),S(4,vt,2,3,"ng-container",2),b(5),p()(),c(6,"div",43)(7,"button",44),C("click",function(e){let a=v(o).target,i=u();return x(i.onIncrement(e,a))}),b(8,"- "),p(),c(9,"input",45),C("input",function(e){let a=v(o).target,i=u();return x(i.brush.settingChanged(e,a))}),p(),c(10,"button",44),C("click",function(e){let a=v(o).target,i=u();return x(i.onIncrement(e,a))}),b(11,"+ "),p()()(),c(12,"div",46)(13,"input",47),C("input",function(e){let a=v(o).target,i=u();return x(i.brush.settingChanged(e,a))}),p()()()}if(r&2){let o=l.target,t=l.title,e=l.icon,n=l.max,a=l.step,i=l.value;s(3),m("for","_"+o),s(),m("ngIf",e!=null&&e!=""),s(),k(" ",t," "),s(2),m("disabled",i==0),s(2),$("title",t),m("name",o)("id","_"+o)("value",i)("step",a)("max",n),s(),m("disabled",i==n),s(3),$("title",t),m("max",n)("step",a)("value",i)("ngStyle",ge(16,xt))}}var yt=(r,l,o,t)=>({width:r,height:l,rotate:o,zoom:t}),Se=function(r){return r.circle="circle",r.rect="rect",r.none="none",r}(Se||{}),G=function(r){return r.portrait="portrait",r.landscape="landscape",r}(G||{}),$t=(()=>{let l=class l{constructor(t,e,n){this.el=t,this.layers=e,this.colors=n,this.paper={ctl:HTMLElement.prototype,listRatio:[{name:"Square (1:1)",value:1},{name:"Common (4:3)",value:4/3},{name:"Wide (16:9)",value:16/9},{name:"Free",value:0}],ratio:4/3,width:640,height:480,orient:G.landscape,onSizeChange:a=>{let i=this.paper;if(i.ratio==0)return;let _=a.target.name;["width","height"].includes(_)&&(_=="width"?i.orient==G.portrait?i.height=i.width*i.ratio:i.height=i.width/i.ratio:_=="height"&&(i.orient==G.portrait?i.width=i.height/i.ratio:i.width=i.height*i.ratio))},onRatioChange:a=>{let i=this.paper,d=Number(i.ratio);d!=0&&(i.orient==G.portrait?i.height=i.width*d:i.height=i.width/d,console.log(i.height))},onOrientChange:a=>{let i=this.paper,d=Number(i.width),_=Number(i.height);i.width=_,i.height=d},onKey:a=>{let i=a.key.toLowerCase(),d=this.brush.prop.stroke;["[","]"].includes(i)&&d.size>=1&&(i=="["&&d.size-1>0?d.size-=1:i=="]"&&(d.size+=1),this.brush.render())},onWheel:a=>{let d=a.deltaY<0?"up":"down",_=a.shiftKey,g=this.canvas;if(_){let h=1*(d=="up"?1:-1);g.rotate+=h}else{let h=3*(d=="up"?1:-1);g.setZoom(h)}}},this.brush={ctl:HTMLCanvasElement.prototype,prop:{stroke:{color:{h:0,s:100,l:50},type:Se.circle,rendered:Image.prototype,fill:100,hardness:50,size:30}},status:{hold:!1},prevPos:{x:0,y:0},curPos:{x:0,y:0},getColor:(a={h:0,s:0,l:0},i=1)=>`hsla(${a.h}, ${a.s}%, ${a.l}%, ${i})`,onMouse:a=>{let i=this.brush;i.status={hold:!1};let d=0,_=0;if(a.type.includes("mouse"))d=a.clientX,_=a.clientY;else if(a.type.includes("touch")&&a.touches.length==1){let ce=a.touches[0];d=ce.clientX,_=ce.clientY}let f=this.el.nativeElement.querySelector("#paper").getClientRects().item(0),O={left:f.left,top:f.top},P=this.brush.prop.stroke.size/2,I=this.canvas.zoom/100,ie={x:d-P-O.left,y:_-P-O.top},A=ie.x,le=ie.y,se=i.ctl,Pe=Number(A)+"px",Oe=Number(le)+"px";se.style.left=Pe,se.style.top=Oe;let Te=a.type.includes("mouse"),Ee=a.type.includes("touchmove")&&a.touches.length==1;i.status.hold=Ee||Te&&a.buttons==1,i.status.hold&&this.paint(A,le,this.canvas.zoom,this.canvas.rotate,this.brush.prop.stroke.rendered)},render:()=>{let a=this.brush,i=a.ctl,d=a.prop.stroke,_=this.canvas.zoom/100,g=d.size*_,h=i.getContext("2d"),f=g/2,O=g/8,P=h.createRadialGradient(f,f,O,f,f,f);P.addColorStop(d.hardness/100,a.getColor(d.color,d.fill/100)),P.addColorStop(1,a.getColor(d.color,0)),i.width=g,i.height=g,h.fillStyle=P,h.fillRect(0,0,i.width,i.height);let I=new Image(g,g);I.onload=()=>d.rendered=I,I.src=i.toDataURL("image/png")},settingChanged:(a,i)=>{let d=Number(a.target.value),_=this.brush.prop.stroke;isNaN(d)||(_[i]=d,this.brush.render())}},this.canvas={zoom:100,rotate:0,setZoom:a=>{this.canvas.zoom+=a,this.brush.render()}},this.layerList=[],this.settings={open:!0,selected:{title:"Tools",icon:"bi-gear"},list:[{title:"Paper",icon:"bi-file-earmark"},{title:"Display",icon:"bi-display"},{title:"Brush",icon:"bi-brush"},{title:"Color",icon:"bi-palette"},{title:"Layers",icon:"bi-layers"}],openChange:a=>{this.settings.open=a}},this.tracker=(a,i)=>i,e.width=this.paper.width,e.height=this.paper.height}ngOnInit(){this.colors.colorChange.subscribe(t=>{this.brush.prop.stroke.color=t,this.brush.render()})}ngAfterViewInit(){let t=this.el.nativeElement,e=this.paper,n=this.brush,a=t.querySelector(".brush");n.ctl=a,n.render(),e.ctl=t.querySelector("#paper"),document.addEventListener("keydown",e.onKey),document.addEventListener("wheel",e.onWheel)}paint(t,e,n,a,i){let _=this.el.nativeElement.querySelector("#layers"),g=this.layers.getActiveElement();if(g==null)return alert("No layers selected!");let h=g.getContext("2d"),f=n/100,P=_.parentElement.getClientRects().item(0),I={x:P.width/2,y:P.height/2},ie=a*Math.PI/180,A={left:t-I.x,top:e-I.y};h.translate(I.x,I.y),h.drawImage(i,A.left,A.top,i.width,i.height),h.setTransform(1,0,0,1,0,0)}onIncrement(t,e){let n=t.target,a=n.parentElement?.querySelector("input"),i=Number(a.step),d=n.innerHTML.replace(/\s/g,""),_=this.brush.prop.stroke;d=="+"?_[e]+=i:d=="-"&&(_[e]-=i),this.brush.render()}};l.\u0275fac=function(e){return new(e||l)(z(H),z(X),z(Y))},l.\u0275cmp=F({type:l,selectors:[["app-paint"]],standalone:!0,features:[ue([{provide:X},{provide:Y}]),L],decls:19,vars:18,consts:[[3,"open","openChange"],["title","",1,"mb-0"],[4,"ngIf"],[1,"btn-group","wh-fill"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"my-3"],["id","viewport",1,"bg-secondary-subtle","start-0","top-0","wh-fill",3,"mousemove","mousedown","touchmove","touchstart"],["id","paper",1,"border","position-absolute","start-50","top-50","translate-middle",3,"ngStyle"],["id","layers",1,"wh-fill"],[1,"brush",3,"mousemove","mousedown","touchmove","touchstart"],["inpSlide",""],[1,"bi","bi-gear"],[1,"ms-2"],["type","radio","name","setting",1,"btn-check",3,"id","title","value","ngModel","ngModelChange"],[1,"btn",3,"for","ngClass"],[1,"p-2"],[1,"mb-3"],["for","_ratio",1,"form-label"],["id","_ratio",1,"form-select","pointer",3,"ngModel","ngModelChange","change"],["for","_orient",1,"form-label"],["id","_orient",1,"form-select","pointer",3,"ngModel","ngModelChange","change"],["value","landscape"],["value","portrait"],["for","_width",1,"form-label"],[1,"input-group"],["id","_width","name","width","type","number","step","100",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-text"],["for","_height",1,"form-label"],["id","_height","name","height","type","number","step","100",1,"form-control",3,"ngModel","ngModelChange","input"],[3,"value"],[1,"d-flex","justify-content-between","align-items-center","gap-3"],[1,"bi","bi-search"],["type","button","title","Reset",1,"btn","rounded-circle","text-secondary",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["type","range","title","Zoom level","min","1","step","1","max","300",1,"form-range",3,"ngModel","ngModelChange","change"],[1,"bi","bi-arrow-repeat"],["type","range","title","Rotation","min","-90","step","1","max","90",1,"form-range",3,"ngModel","ngModelChange"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"height","width","list"],[3,"width","height","hidden","id"],[1,"row","align-items-baseline"],[1,"col-5"],[1,"form-label",3,"for"],[1,"col","input-group"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["type","number","inputmode","numeric","min","0",1,"form-control",3,"name","id","value","title","step","max","input"],[1,"w-fill"],["type","range","min","0",1,"form-range",3,"title","max","step","value","ngStyle","input"]],template:function(e,n){e&1&&(c(0,"app-draggable",0),C("openChange",function(i){return n.settings.openChange(i)}),c(1,"div",1),S(2,nt,4,0,"ng-container",2)(3,it,4,4,"ng-container",2),p(),c(4,"div",3),S(5,rt,4,12,"ng-container",4),p(),c(6,"div",5),S(7,lt,33,6,"ng-container",2)(8,st,17,4,"ng-container",2)(9,_t,4,12,"ng-container",2)(10,ht,2,0,"ng-container",2)(11,ft,2,3,"ng-container",2),p()(),c(12,"div",6),C("mousemove",function(i){return n.brush.onMouse(i)})("mousedown",function(i){return n.brush.onMouse(i)})("touchmove",function(i){return n.brush.onMouse(i)})("touchstart",function(i){return n.brush.onMouse(i)}),c(13,"section",7)(14,"div",8),S(15,Ct,2,4,"ng-container",4),p(),c(16,"canvas",9),C("mousemove",function(i){return n.brush.onMouse(i)})("mousedown",function(i){return n.brush.onMouse(i)})("touchmove",function(i){return n.brush.onMouse(i)})("touchstart",function(i){return n.brush.onMouse(i)}),p()()(),S(17,bt,14,17,"ng-template",null,10,U)),e&2&&(m("open",n.settings.open),s(2),m("ngIf",!n.settings.open),s(),m("ngIf",n.settings.open),s(2),m("ngForOf",n.settings.list)("ngForTrackBy",n.tracker),s(2),m("ngIf",n.settings.selected.title=="Paper"),s(),m("ngIf",n.settings.selected.title=="Display"),s(),m("ngIf",n.settings.selected.title=="Brush"),s(),m("ngIf",n.settings.selected.title=="Color"),s(),m("ngIf",n.settings.selected.title=="Layers"),s(2),m("ngStyle",_e(13,yt,n.paper.width+"px",n.paper.height+"px",n.canvas.rotate+"deg",n.canvas.zoom/100)),s(2),m("ngForOf",n.layerList)("ngForTrackBy",n.tracker))},dependencies:[R,D,j,B,Q,J,ne,ye,we,fe,Ce,xe,be,ve,ee,te,Me,X,Y],styles:[".no-select[_ngcontent-%COMP%], #paper[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;cursor:none}.flex[_ngcontent-%COMP%], .flex-center[_ngcontent-%COMP%]{display:flex}.flex-center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.w-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{width:-webkit-fill-available}.h-fill[_ngcontent-%COMP%], .wh-fill[_ngcontent-%COMP%]{height:-webkit-fill-available}.w-min[_ngcontent-%COMP%]{width:min-content}.p-1[_ngcontent-%COMP%]{padding:.25rem}.pointer[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{cursor:pointer}.cursor-default[_ngcontent-%COMP%]{cursor:default!important}.cursor-all[_ngcontent-%COMP%]{cursor:all-scroll}.cursor-resize[_ngcontent-%COMP%]{cursor:nw-resize}.hover[_ngcontent-%COMP%]:hover{background-color:#dcdcdc}p[_ngcontent-%COMP%], div[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{overflow:hidden}*[_ngcontent-%COMP%]{box-sizing:border-box}[id*=menu-][_ngcontent-%COMP%]{z-index:1000}#viewport[_ngcontent-%COMP%]{z-index:0}#paper[_ngcontent-%COMP%]{z-index:1;background-image:url(https://previews.123rf.com/images/oporty/oporty1809/oporty180900392/109475612-transparency-tile-for-background-not-seamless-chess-checkerboard.jpg);background-repeat:repeat;background-size:300px 300px;transform-box:border-box;transform-origin:left top}#layers[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}.brush[_ngcontent-%COMP%]{transform-box:border-box;position:absolute;border:1px solid;border-radius:50%;z-index:500}"]});let r=l;return r})();export{$t as PaintComponent};
